{% comment %} Base layout â€” do NOT extend anything here {% endcomment %}
{% load static %}
<!DOCTYPE html>
<html lang="pt">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}Micro-SOP Generator{% endblock %}</title>

    <!-- Tailwind bundle you build (include your utilities/components) -->
    <link rel="stylesheet" href="{% static 'css/styles.css' %}" />

    <!-- HTMX (+ optional helpers) -->
    <script src="https://unpkg.com/htmx.org@1.9.12" defer></script>
    <script src="https://unpkg.com/hyperscript.org@0.9.12" defer></script>
    <script src="https://unpkg.com/htmx.org/dist/ext/transition.js" defer></script>
  </head>

  <body class="bg-gray-950 text-white antialiased">
    <!-- (Optional) Navbar goes here -->

    <main class="min-h-screen px-6 py-10">
      {% block content %}{% endblock %}
    </main>

    <div id="modal"
        class="fixed inset-0 hidden z-50 bg-black/60 backdrop-blur-sm
                flex items-center justify-center p-4">
      <!-- HTMX swaps into this -->
      <div id="modal-content" class="w-full max-w-md"></div>
    </div>

    <!-- Modal helpers -->
    <script>
      function showModal() {
        const m = document.getElementById('modal');
        if (m) m.classList.remove('hidden');
      }
      function closeModal() {
        const m = document.getElementById('modal');
        if (!m) return;
        m.classList.add('hidden');
        const c = document.getElementById('modal-content');
        if (c) c.innerHTML = '';
      }

      // Open automatically whenever HTMX swaps into #modal-content
      document.body.addEventListener('htmx:afterSwap', (e) => {
        if (e.detail?.target?.id === 'modal-content') showModal();
      });

      // Close on ESC
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
      });

      // Close when clicking the backdrop (but not inside the card)
      document.addEventListener('click', (e) => {
        const m = document.getElementById('modal');
        if (m && e.target === m) closeModal();
      });
    </script>
  </body>
</html>
