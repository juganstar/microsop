<div class="bg-gray-900 text-white rounded-2xl shadow-xl max-w-md w-full p-8 relative">
  <h2 class="text-2xl font-bold mb-4 text-center">{% trans "Login to your account" %}</h2>

  <form 
    hx-post="/auth/login/"
    hx-target="#modal-content"
    hx-swap="innerHTML"
    class="space-y-4"
  >
    {% csrf_token %}

    <div>
      <label class="block text-sm mb-1 font-medium">{% trans "Email" %}</label>
      <input type="email" name="email" required
             class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2" />
    </div>

    <div>
      <label class="block text-sm mb-1 font-medium">{% trans "Password" %}</label>
      <input type="password" name="password" required
             class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-2" />
    </div>

    <button type="submit"
            class="w-full bg-purple-600 hover:bg-purple-700 py-2 rounded-xl font-medium text-lg transition">
      {% trans "Login" %}
    </button>
  </form>

  <button onclick="closeModal()" class="absolute top-3 right-3 text-gray-400 hover:text-white text-xl">
    &times;
  </button>
</div>

<script>
  document.body.addEventListener('htmx:afterRequest', function (evt) {
    if (evt.detail.xhr && evt.detail.xhr.status === 200) {
      try {
        const res = JSON.parse(evt.detail.xhr.response);
        if (res.key) {
          // Success â€” session should be active now
          window.location.reload();  // Reload to refresh homepage/dashboard
        }
      } catch (err) {
        console.error("Erro ao processar resposta de login:", err);
      }
    }
  });

  function closeModal() {
    const modal = document.getElementById('modal');
    if (modal) modal.classList.add('hidden');
  }
</script>
